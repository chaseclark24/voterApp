
<!doctype html>
<html>
<head>
    <meta charset=utf-8 name="viewport" content="width=device-width, initial-scale=1">
    <title>Voter</title>
    <link rel=stylesheet href=css/ui-block.css>
    <!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	<script src=./dist/nebPay.js></script>
</head>
<body onload="">
        

    <div class = "page-header">
    	<a href="./index.html">
        <h1 class="glyphicon glyphicon-th-list" aria-hidden="true"> Nebulas Polls</h1>
    	</a>
    </div>

    <form>
    <div class="formDiv">
      <label for="usr">Poll Topic:</label>
      <input type="text" class="form-control" id="topic">
    </div>
    <div class="formDiv">
      <label for="pwd">Option 1:</label>
      <input type="text" class="form-control" id="opt1">
    </div>
    <div class="formDiv">
      <label for="pwd">Option 2:</label>
      <input type="text" class="form-control" id="opt2">
    </div>
    <div class="formDiv">
      <label for="pwd">Option 3 (optional):</label>
      <input type="text" class="form-control" id="opt3">
    </div>
    <div class="formDiv">
      <label for="pwd">Option 4 (optional):</label>
      <input type="text" class="form-control" id="opt4">
    </div>
    </form>
    </div>
    
    <div class="formDiv"> 
        <div class="row">    
            <div class="col-md-5">
                <button type="button" class="btn btn-primary btn-lg" id="submitButton"  onclick="savePoll()">Submit</button>
            </div>
        </div>
    </div>



    <!-- All of these scripts are dependancies from the Nebulas Web Wallet -->
 	<script type="text/javascript" src=./dist/nebPay.js></script>
    <script type="text/javascript">
        "use strict";

        // Global variables used by our Dapp
        var contract_address = "n1kYLC31BZCjWrBesgZFf2GuF3YkrpDTEog";
      	var NebPay = require("nebpay");
      	var nebPay = new NebPay();
      	var callbackUrl = NebPay.config.testnetUrl;
      	function savePoll(){
      		var topic = document.getElementById("topic").value; 
      		var opt1 = document.getElementById("opt1").value; 
      		var opt2 = document.getElementById("opt2").value; 
      		var opt3 = document.getElementById("opt3").value; 
      		var opt4 = document.getElementById("opt4").value; 
      		nebPay.call(contract_address, 0, "newPoll", JSON.stringify([topic, opt1, opt2, opt3, opt4]), {
      		callback: callbackUrl,
      		listener: onSavePoll
      		});

      	function onSavePoll(resp){
      		pollName= resp.result.replace('"','');
          	pollName = pollName.replace('"','')
          	alert(pollName)
      		window.location = location.protocol + '//' + location.host + "/C:/Users/Chase/Documents/websiteDocs/nebulasApps/voter/pollView.html" + '?' + pollName;
      	}



      	}
    </script>
</body>
</html>